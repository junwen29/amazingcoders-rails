<div id="venue_chart" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

<footer>
  <script>
      $(document).ready(function () {
          $('#venue_chart').highcharts({
              chart: {
                  type: 'column'
              },
              credits: {
                  enabled: false
              },
              title: {
                  text: 'Popularity of Venues'
              },
              subtitle: {
                  text: 'Redemption Count'
              },
              yAxis: {
                  allowDecimals: false,
                  min: 0,
                  title: {
                      text: 'Number of Users'
                  }
              },
              xAxis: {
                  labels: {
                      enabled: false
                  }
              },
              legend: {
                  layout: 'vertical',
                  align: 'right',
                  verticalAlign: 'top',
                  y: 30
              },
              series: [
                  <% loop = 0 %>
                  <% num_of_venues = @deals_by_venue.size%>
                  <% while loop < num_of_venues %>
                  <% redeem_placement = @deals_by_venue[loop].size - 1 %>
                  {
                      name: "<%= @deals_by_venue[loop][0] %>",
                      data: [
                          {
                              name: "<%= @deals_by_venue[loop][0] %>",
                              y: <%= @deals_by_venue[loop][redeem_placement] %>,
                              drilldown: "<%= @deals_by_venue[loop][0] %>" + " redeem"
                          }
                      ]
                  },
                  <% loop = loop + 1 %>
                  <% end %>
              ],
              drilldown: {
                  series: [
                      <% loop = 0 %>
                      <% while loop < num_of_venues %>
                      {
                          name: "Redemption Count",
                          id: "<%= @deals_by_venue[loop][0] %>" + " redeem",
                          data: [
                              <% inner_loop = 1 %>
                              <% num_of_deals = @deals_by_venue[loop].size - 2 %>
                              <% while inner_loop < num_of_deals %>
                              [
                                  "<%= @deals_by_venue[loop][inner_loop][0] %>", <%= @deals_by_venue[loop][inner_loop][1] %>
                              ],
                              <% inner_loop = inner_loop + 1 %>
                              <% end %>
                          ]
                      },
                      <% loop = loop + 1 %>
                      <% end %>
                  ]
              }
          });
      });
  </script>
</footer>