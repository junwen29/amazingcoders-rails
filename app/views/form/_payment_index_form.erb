<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      Your Current Plan
    </h4>
  </div>
  <div class="panel-body">
    <% if (!@current_payment) %>
        <div class="alert alert-danger" role="alert">
          Oops, you have not subscribed to any premium service at the moment.
          <a href="<%= new_payment_path %>">Upgrade your plan</a> to unlock more awesome features from Burpple!
        </div>
    <% else %>
        <div class="col-lg-6">
          <p>
            <strong>Plan: </strong>
            <% if (@current_payment.plan1) %>
                <span class="label label-default">Deals Listing Service</span>
            <% end %>
          </p>
          <p>
            <strong>Add-Ons: </strong>
            <% if !(@current_payment.add_on1) && !(@current_payment.add_on2) && !(@current_payment.add_on3)%>
                <span class="label label-inverse">None</span>
            <% else %>
                <% if (@current_payment.add_on1) %>
                    <span class="label label-info">Push Notification</span>
                <% end %>
                <% if (@current_payment.add_on2) %>
                    <span class="label label-success">Deals Statistics</span>
                <% end %>
                <% if (@current_payment.add_on3) %>
                    <span class="label label-warning">Aggregate Trends</span>
                <% end %>
            <% end %>
          </p>
        </div>
        <div class="col-lg-6">
          <p>
            <strong>Start Date: </strong>
            <%= @current_payment.start_date.strftime("%d/%m/%Y") %>
          </p>
          <p>
            <strong>Expiry Date: </strong>
            <%= @current_payment.expiry_date.strftime("%d/%m/%Y") %>
          </p>
        </div>
    <% end %>
  </div><!-- panel-body -->
</div><!-- panel -->

<!-- Content Body -->
<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      Transaction History
    </h4>
  </div>
  <div class="panel-body">
    <table class="table table-bordered table-hover table-responsive">
      <tr>
        <th>Transaction ID</th>
        <th>Total Amount</th>
        <th>Premium Service</th>
        <th>Add-On(s)</th>
        <th>Start Date</th>
        <th>Expiry Date</th>
        <th>Payment Date</th>
      </tr>

      <% @payments.each do |p| %>
          <% if !p.paid %>
              <% p.destroy %>
          <% end %>
      <% end %>
      <% @payments.each do |payment| %>
          <tr>
            <td><%= payment.id %></td>
            <td><%= number_to_currency payment.total_cost %></td>
            <td>
              <% if (payment.plan1) %>
                  Deals Listing Service
              <% end %>
            </td>
            <td>
              <% if !(payment.add_on1) && !(payment.add_on2) && !(payment.add_on3)%>
                  <span class="label label-inverse">None</span>

              <% else %>
                  <% if (payment.add_on1) %>
                      <span class="label label-info">Push Notification</span>
                  <% end %>
                  <% if (payment.add_on2) %>
                      <span class="label label-success">Deal Statistics</span>
                  <% end %>
                  <% if (payment.add_on3) %>
                      <span class="label label-warning">Aggregate Trends</span>
                  <% end %>
              <% end %>
            </td>
            <td><%= payment.start_date.strftime("%d/%m/%Y") %> </td>
            <td><%= payment.expiry_date.strftime("%d/%m/%Y") %> </td>
            <td><%= payment.created_at.strftime("%d/%m/%Y %r")%></td>
          </tr>
      <% end %>
    </table>
  </div>
</div>